-- prepares a MySQL server for the project

CREATE DATABASE IF NOT EXISTS db_dev;
CREATE USER IF NOT EXISTS 'dev_usr'@'localhost' IDENTIFIED BY 'dev_pwd';
GRANT ALL PRIVILEGES ON `db_dev`.* TO 'dev_usr'@'localhost';
GRANT SELECT ON `performance_schema`.* TO 'dev_usr'@'localhost';
FLUSH PRIVILEGES;

use db_dev;
-- Create tables for the models

-- Pet table
CREATE TABLE allpets (
    id INT AUTO_INCREMENT PRIMARY KEY,
    serial VARCHAR(100) UNIQUE NOT NULL,
    gender VARCHAR(10) NOT NULL,
    pet_type VARCHAR(20) NOT NULL,
    pet_status VARCHAR(20),
    medical_history JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Insert dummy records into the Pet table
INSERT INTO allpets (serial, gender, pet_type, pet_status, medical_history)
VALUES
    ('123ABC', 'male', 'cat', 'not adopted', '{"checkups": ["checkup1", "checkup2"]}'),
    ('456DEF', 'female', 'dog', 'adopted', '{"checkups": ["checkup3"]}'),
    ('789GHI', 'male', 'cat', 'not adopted', '{"checkups": ["checkup4"]}');

-- Medical History table
CREATE TABLE medic_history (
    id INT AUTO_INCREMENT PRIMARY KEY,
    pet_id INT NOT NULL,
    checkup_timestamp TIMESTAMP NOT NULL,
    checkup_summary TEXT,
    FOREIGN KEY (pet_id) REFERENCES allpets(id)
);

-- Insert dummy records into the Medical History table
INSERT INTO medic_history (pet_id, checkup_timestamp, checkup_summary)
VALUES
    (1, '2023-01-15 08:00:00', 'Routine checkup for cat'),
    (2, '2023-02-20 10:30:00', 'Follow-up checkup for dog'),
    (3, '2023-03-25 11:45:00', 'Initial health check for cat');

-- Food table
CREATE TABLE allfood (
    id INT AUTO_INCREMENT PRIMARY KEY,
    food_name VARCHAR(100) NOT NULL,
    food_stock INT NOT NULL,
    food_type VARCHAR(20) NOT NULL,
    food_expiry_date DATE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Insert dummy records into the Food table
INSERT INTO allfood (food_name, food_stock, food_type, food_expiry_date)
VALUES
    ('Dry Food', 100, 'cat', '2023-12-31'),
    ('Wet Food', 50, 'dog', '2023-11-30'),
    ('Treats', 75, 'dog', '2024-05-15');

-- Create Client table
CREATE TABLE allclients (
    id INT AUTO_INCREMENT PRIMARY KEY,
    client_name VARCHAR(100) NOT NULL,
    pet_serial VARCHAR(100),
    pet_type VARCHAR(20),
    gender VARCHAR(10),
    checked_in_timestamp TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Insert dummy records into Client table
INSERT INTO allclients (client_name, pet_serial, pet_type, gender, checked_in_timestamp)
VALUES
    ('John Doe', '123ABC', 'cat', 'male', '2023-01-01 09:00:00'),
    ('Jane Smith', '456DEF', 'dog', 'female', '2023-02-05 11:30:00'),
    ('Alice Johnson', NULL, NULL, NULL, '2023-03-10 15:45:00');

-- Create Blog table
CREATE TABLE allblogs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(100) NOT NULL,
    body TEXT NOT NULL,
    short_description VARCHAR(200),
    author VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Insert dummy records into Blog table
INSERT INTO allblogs (title, body, short_description, author)
VALUES
    ('First Blog Post', 'This is the content of the first blog post.', 'First post.', 'John Doe'),
    ('Second Blog Post', 'This is the content of the second blog post.', 'Second post.', 'Jane Smith'),
    ('Third Blog Post', 'This is the content of the third blog post.', 'Third post.', 'Alice Johnson');

-- Create ShelterOverview table
CREATE TABLE shelter_overview (
    id INT AUTO_INCREMENT PRIMARY KEY,
    total_regi_pets INT DEFAULT 0,
    total_food INT DEFAULT 0,
    total_checkup INT DEFAULT 0,
    total_clients INT DEFAULT 0,
    total_users INT DEFAULT 0,
    total_blogs INT DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- No dummy records provided as they are calculated or derived
